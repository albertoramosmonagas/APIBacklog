| **Field** | Description | 
| ---- | ----- |
| API family name | Consent URL API (TBC) |
| API family owner | Telefonica |
| API summary | **Disclaimer** This API proposal DOES NOT aim for delegating consent or privacy management. The operator remains under control of the process while the developer is just in charge of exposing the capture URL webpage to the user.<br><br>Current consent management is based on: <br>- **Frontend flow (Authcode)**: Since the authorization code grant involves the interaction with application front-end, consent can be captured directly from the user through the application browser. Taking advantage of the frontend flow, consent can directly be captured through an interactive dialogue with the End-User. <br>- **Backend flow (CIBA)**: Out-of-band consent capture is employed in backend flows as part of asynchronous CIBA flow, where the operator is in charge of reaching the End-User and capturing the consent if needed, based on the channels that each operator supports (e.g. push notification with fallback to SMS, etc...).<br><br>Developers are therefore mandated to capture the consent in the frontend flow, or delegate the moment of capture to the operator, which may or may not be able to reach the customer in a successful way. <br><br>With the proposed API, the developer will be able to retrieve a similar consent webpage URL as is managed in the Frontend flow (Authcode) process, but from a backend server and being able to show it to the customer in any device or application that best fits the developer's app use case. User can then access this telco webpage using its telco credentials, and provide a clear consent acceptance. <br><br>The API takes advantage of the developer's knowledge of the customers, based on the use case that they manage, to trigger the consent capture process at the moment and channel that best fit with each customer, while ensuring that privacy management and ownership remain with the operator. The process can be included in onboarding processes, where the developer can gather the consent in advance, ready by the moment the API(s) need to be called. <br><br>Scenarios to cover:<br>- Pure backend services where no user device is involved, i.e. no possibility for a frontend flow. There are a lot of antifraud use cases that do not require a pure user action to be executed (as application checks are done in background), therefore we cannot count on the user being on a device APP. <br>- Services that are executed over a device which has no user interaction possibilities.<br>- Consent capture campaigns without frontend flows. <br><br>_Special considerations, following those applied to CIBA/AuthCode Access Token retrieval mechanisms, will need to be implemented to avoid this API being used as a telco-finder to determine whether the user phone number is in use or whether it belongs to a certain operator._<br><br>Additionally, this API provides the API Consumer with the ability to:<br>- Indicate the applicable Legal Basis (e.g. `dpv:Consent`, `dpv:LegitimateInterest`) for the requested scopes and purpose according to relevant legal frameworks.<br>- Provide the data processing validity status (`statusValidForProcessing`) and reason (`statusReason` if false) to explain why processing is not permitted if applicable.<br>- Offer a Consent Capture URL only if `dpv:Consent` is the legal basis and `requestCaptureUrl` is set to `true`, allowing the user to provide or renew consent. Importantly, this API does not delegate consent capture to the developer — it empowers the developer to present the operator’s Consent capture URL at the most opportune time and place, while the actual consent capture takes place within the operator’s secure environment ensuring proper user authentication. |
| Technical viability | The API returns a consent capture URL, provided by the operator and following the same or similar interactive dialogue as in the frontend flow. This allows the developer to present a consent capture process to the end-user for the requested scopes and purpose. <br>**Inputs Explained:**<br>- **User identifier**: Phone number of the end-user, which identifies the line whose consent is required to access the specific service.<br>- **Scope**: List of API PIScope(s) and a specific purpose, following the format defined by [CAMARA-API-access-and-user-consent.md](https://github.com/camaraproject/IdentityAndConsentManagement/blob/main/documentation/CAMARA-API-access-and-user-consent.md) <br>**Output:**<br>- **Consent URL**: URL containing the telco webpage for consent capture, including its own subscriber authentication with telco credentials.<br>- **statusValidForProcessing**: Boolean indicating if the data processing is permitted for the given legal basis.<br>- **statusReason**: Explanation if `statusValidForProcessing` is false. <br>_Technical details on URL format and webpage may be defined during specification process._ |
| Commercial viability | **Current use cases validating the service:**<br>1. **Consent capture during end-user onboarding**: The developer, when registering the user in a digital or physical procedure, can take advantage of the presence of the end-user during the process to pre-capture the consent for the set of APIs that the user is later going to require. <br>2. **Consent capture in application notification**: Developers can push a notification in their app so that customers can access directly to the consent capture process in this easy-to-access place. <br>3. **Consent capture campaigns**: Applications can create campaigns by email or other channels to capture the consent for substantial chunks of their user base. |
| YAML code available? | NO<br> To be provided |
| Validated in lab/productive environments? | YES |
| Validated with real customers? | YES |
| Validated with operators? | NO |
| Supporters in API Backlog Working Group | Telefonica, KPN |